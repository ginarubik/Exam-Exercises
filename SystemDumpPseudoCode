// PROGmasters Exam â€“ System Dump (Java Pseudocode)

class Software {
    String name;
    String type; // Express or Light
    int capacityConsumption;
    int memoryConsumption;

    constructor(name, type, capacity, memory) {
        this.name = name;
        this.type = type;

        if (type == "Express") {
            this.capacityConsumption = capacity;
            this.memoryConsumption = memory * 2;
        } 
        else if (type == "Light") {
            this.capacityConsumption = capacity + (capacity / 2);
            this.memoryConsumption = memory - (memory / 2);
        }
    }
}

class Hardware {
    String name;
    String type; // Power or Heavy
    int maximumCapacity;
    int maximumMemory;
    List<Software> softwares;

    constructor(name, type, capacity, memory) {
        this.name = name;
        this.type = type;
        this.softwares = new List<>();

        if (type == "Power") {
            this.maximumCapacity = capacity - ((capacity * 3) / 4);
            this.maximumMemory = memory + ((memory * 3) / 4);
        } 
        else if (type == "Heavy") {
            this.maximumCapacity = capacity * 2;
            this.maximumMemory = memory - (memory / 4);
        }
    }

    int getUsedCapacity() {
        sum = 0;
        for (Software s : softwares)
            sum += s.capacityConsumption;
        return sum;
    }

    int getUsedMemory() {
        sum = 0;
        for (Software s : softwares)
            sum += s.memoryConsumption;
        return sum;
    }

    void addSoftware(Software s) {
        if (getUsedCapacity() + s.capacityConsumption <= maximumCapacity &&
            getUsedMemory() + s.memoryConsumption <= maximumMemory) {
            softwares.add(s);
        }
    }

    void removeSoftware(String softwareName) {
        for (Software s : softwares) {
            if (s.name == softwareName) {
                softwares.remove(s);
                break;
            }
        }
    }
}

class SystemManager {
    List<Hardware> hardwareComponents = new List<>();

    void registerPowerHardware(String name, int capacity, int memory) {
        hardwareComponents.add(new Hardware(name, "Power", capacity, memory));
    }

    void registerHeavyHardware(String name, int capacity, int memory) {
        hardwareComponents.add(new Hardware(name, "Heavy", capacity, memory));
    }

    Hardware findHardware(String name) {
        for (Hardware h : hardwareComponents)
            if (h.name == name)
                return h;
        return null;
    }

    void registerExpressSoftware(String hardwareName, String name, int capacity, int memory) {
        Hardware h = findHardware(hardwareName);
        if (h == null) return;

        Software s = new Software(name, "Express", capacity, memory);
        h.addSoftware(s);
    }

    void registerLightSoftware(String hardwareName, String name, int capacity, int memory) {
        Hardware h = findHardware(hardwareName);
        if (h == null) return;

        Software s = new Software(name, "Light", capacity, memory);
        h.addSoftware(s);
    }

    void releaseSoftwareComponent(String hardwareName, String softwareName) {
        Hardware h = findHardware(hardwareName);
        if (h == null) return;

        h.removeSoftware(softwareName);
    }

    void analyze() {
        int hardwareCount = hardwareComponents.size();
        int softwareCount = 0;
        int totalUsedMemory = 0;
        int totalUsedCapacity = 0;
        int totalMaxMemory = 0;
        int totalMaxCapacity = 0;

        for (Hardware h : hardwareComponents) {
            softwareCount += h.softwares.size();
            totalUsedMemory += h.getUsedMemory();
            totalUsedCapacity += h.getUsedCapacity();
            totalMaxMemory += h.maximumMemory;
            totalMaxCapacity += h.maximumCapacity;
        }

        print("System Analysis");
        print("Hardware Components: " + hardwareCount);
        print("Software Components: " + softwareCount);
        print("Total Operational Memory: " + totalUsedMemory + " / " + totalMaxMemory);
        print("Total Capacity Taken: " + totalUsedCapacity + " / " + totalMaxCapacity);
    }

    void dump() {
        List<Hardware> powerList = new List<>();
        List<Hardware> heavyList = new List<>();

        for (Hardware h : hardwareComponents) {
            if (h.type == "Power") powerList.add(h);
            else heavyList.add(h);
        }

        printHardwareList(powerList);
        printHardwareList(heavyList);
    }

    void printHardwareList(List<Hardware> list) {
        for (Hardware h : list) {

            int expressCount = 0;
            int lightCount = 0;

            for (Software s : h.softwares) {
                if (s.type == "Express") expressCount++;
                else if (s.type == "Light") lightCount++;
            }

            print("Hardware Component - " + h.name);
            print("Express Software Components - " + expressCount);
            print("Light Software Components - " + lightCount);
            print("Memory Usage: " + h.getUsedMemory() + " / " + h.maximumMemory);
            print("Capacity Usage: " + h.getUsedCapacity() + " / " + h.maximumCapacity);
            print("Type: " + h.type);

            if (h.softwares.size() == 0) {
                print("Software Components: None");
            } else {
                names = "";
                for (Software s : h.softwares)
                    names += s.name + ", ";

                removeLastComma(names);
                print("Software Components: " + names);
            }
        }
    }
}
