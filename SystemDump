import java.util.*;

class Software {
    String name;
    String type; // Express or Light
    int capacityConsumption;
    int memoryConsumption;

    public Software(String name, String type, int capacity, int memory) {
        this.name = name;
        this.type = type;

        if (type.equals("Express")) {
            this.capacityConsumption = capacity;
            this.memoryConsumption = memory * 2;
        } else { // Light
            this.capacityConsumption = capacity + (capacity / 2);
            this.memoryConsumption = memory - (memory / 2);
        }
    }
}

class Hardware {
    String name;
    String type; // Power or Heavy
    int maximumCapacity;
    int maximumMemory;
    List<Software> softwares;

    public Hardware(String name, String type, int capacity, int memory) {
        this.name = name;
        this.type = type;
        this.softwares = new ArrayList<>();

        if (type.equals("Power")) {
            this.maximumCapacity = capacity - ((capacity * 3) / 4);
            this.maximumMemory = memory + ((memory * 3) / 4);
        } else { // Heavy
            this.maximumCapacity = capacity * 2;
            this.maximumMemory = memory - (memory / 4);
        }
    }

    public int getUsedCapacity() {
        int sum = 0;
        for (Software s : softwares) {
            sum += s.capacityConsumption;
        }
        return sum;
    }

    public int getUsedMemory() {
        int sum = 0;
        for (Software s : softwares) {
            sum += s.memoryConsumption;
        }
        return sum;
    }

    public void addSoftware(Software s) {
        if (getUsedCapacity() + s.capacityConsumption <= maximumCapacity &&
            getUsedMemory() + s.memoryConsumption <= maximumMemory) {
            softwares.add(s);
        }
    }

    public void removeSoftware(String softwareName) {
        softwares.removeIf(s -> s.name.equals(softwareName));
    }
}

class SystemManager {
    List<Hardware> hardwareComponents = new ArrayList<>();

    private Hardware findHardware(String name) {
        for (Hardware h : hardwareComponents) {
            if (h.name.equals(name)) {
                return h;
            }
        }
        return null;
    }

    public void registerPowerHardware(String name, int capacity, int memory) {
        hardwareComponents.add(new Hardware(name, "Power", capacity, memory));
    }

    public void registerHeavyHardware(String name, int capacity, int memory) {
        hardwareComponents.add(new Hardware(name, "Heavy", capacity, memory));
    }

    public void registerExpressSoftware(String hardwareName, String name, int capacity, int memory) {
        Hardware h = findHardware(hardwareName);
        if (h == null) return;
        h.addSoftware(new Software(name, "Express", capacity, memory));
    }

    public void registerLightSoftware(String hardwareName, String name, int capacity, int memory) {
        Hardware h = findHardware(hardwareName);
        if (h == null) return;
        h.addSoftware(new Software(name, "Light", capacity, memory));
    }

    public void releaseSoftwareComponent(String hardwareName, String softwareName) {
        Hardware h = findHardware(hardwareName);
        if (h == null) return;
        h.removeSoftware(softwareName);
    }

    public void analyze() {
        int hardwareCount = hardwareComponents.size();
        int softwareCount = 0;
        int totalUsedMemory = 0;
        int totalUsedCapacity = 0;
        int totalMaxMemory = 0;
        int totalMaxCapacity = 0;

        for (Hardware h : hardwareComponents) {
            softwareCount += h.softwares.size();
            totalUsedMemory += h.getUsedMemory();
            totalUsedCapacity += h.getUsedCapacity();
            totalMaxMemory += h.maximumMemory;
            totalMaxCapacity += h.maximumCapacity;
        }

        System.out.println("System Analysis");
        System.out.println("Hardware Components: " + hardwareCount);
        System.out.println("Software Components: " + softwareCount);
        System.out.println("Total Operational Memory: " + totalUsedMemory + " / " + totalMaxMemory);
        System.out.println("Total Capacity Taken: " + totalUsedCapacity + " / " + totalMaxCapacity);
    }

    public void dump() {
        List<Hardware> power = new ArrayList<>();
        List<Hardware> heavy = new ArrayList<>();

        for (Hardware h : hardwareComponents) {
            if (h.type.equals("Power")) power.add(h);
            else heavy.add(h);
        }

        printHardware(power);
        printHardware(heavy);
    }

    private void printHardware(List<Hardware> list) {
        for (Hardware h : list) {
            int expressCount = 0;
            int lightCount = 0;

            for (Software s : h.softwares) {
                if (s.type.equals("Express")) expressCount++;
                else lightCount++;
            }

            System.out.println("Hardware Component - " + h.name);
            System.out.println("Express Software Components - " + expressCount);
            System.out.println("Light Software Components - " + lightCount);
            System.out.println("Memory Usage: " + h.getUsedMemory() + " / " + h.maximumMemory);
            System.out.println("Capacity Usage: " + h.getUsedCapacity() + " / " + h.maximumCapacity);
            System.out.println("Type: " + h.type);

            if (h.softwares.isEmpty()) {
                System.out.println("Software Components: None");
            } else {
                List<String> names = new ArrayList<>();
                for (Software s : h.softwares) {
                    names.add(s.name);
                }
                System.out.println("Software Components: " + String.join(", ", names));
            }
        }
    }
}

public class Main {
    public static void main(String[] args) {

        SystemManager system = new SystemManager();

        // ===== TEST CASE (same as example) =====

        system.registerPowerHardware("HDD", 200, 200);
        system.registerHeavyHardware("SSD", 400, 400);

        system.analyze();

        system.registerLightSoftware("HDD", "Test", 0, 10);
        system.registerExpressSoftware("HDD", "Test2", 100, 100);
        system.registerExpressSoftware("HDD", "Test3", 50, 100);

        system.registerLightSoftware("SSD", "Windows", 20, 50);
        system.registerExpressSoftware("SSD", "Linux", 50, 100);
        system.registerLightSoftware("SSD", "Unix", 20, 50);

        system.analyze();

        system.releaseSoftwareComponent("SSD", "Linux");

        system.dump();
    }
}
